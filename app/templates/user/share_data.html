{% extends "base.html" %}

{% block title %}CGTools - Share Data{% endblock %}

{% block content %}
<main class="container share-data-page">
  <h1>Share Data</h1>
  <p>Select the data you want to share and who you want to share it with.</p>

  <form method="POST" action="{{ url_for('user.share') }}" class="share-form">
    {{ form.hidden_tag() }}

    <div class="mb-3">
      {{ form.recipient_id.label(class="form-label") }}
      {{ form.recipient_id(class="form-select") }}
    </div>

    <div class="mb-3">
      {{ form.summary_id.label(class="form-label") }}
      {{ form.summary_id(class="form-select") }}
    </div>

    <button type="submit" class="btn btn-primary">
      {{ form.submit.label.text }}
    </button>
  </form>

  <section class="history mt-5">
    <h2>Shared by Me</h2>
    <table class="table">
      <thead>
        <tr>
          <th>Recipient</th>
          <th>File</th>
          <th>CGT Amount</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for share in shared_by_me %}
        <tr>
          <td>{{ share.to_user.username }}</td>
          <td>{{ share.summary.filename }}</td>
          <td>${{ '%.2f' % share.summary.total_cgt }}</td>
          <td>{{ share.timestamp.strftime('%Y-%m-%d') }}</td>
        </tr>
        {% else %}
        <tr><td colspan="4"><em>No summaries shared yet.</em></td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <section class="history mt-4">
    <h2>Shared with Me</h2>
    <table class="table">
      <thead>
        <tr>
          <th>Sender</th>
          <th>File</th>
          <th>CGT Amount</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for share in shared_with_me %}
        <tr>
          <td>{{ share.from_user.username }}</td>
          <td>{{ share.summary.filename }}</td>
          <td>${{ '%.2f' % share.summary.total_cgt }}</td>
          <td>{{ share.timestamp.strftime('%Y-%m-%d') }}</td>
        </tr>
        {% else %}
        <tr><td colspan="4"><em>No one has shared with you yet.</em></td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
</main>
{% endblock %}